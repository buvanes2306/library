<!DOCTYPE html>
<html>
<head>
    <title>Comprehensive Page Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; }
        .result { margin: 10px 0; padding: 10px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        .page-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .status-indicator { padding: 5px 10px; border-radius: 5px; }
        .working { background: #d4edda; color: #155724; }
        .broken { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Comprehensive Page Test</h1>
    <p><strong>Instructions:</strong> Test each page systematically. Check console for errors and verify functionality.</p>
    
    <div class="page-grid">
        <div class="test-section">
            <h2>ğŸ  Dashboard</h2>
            <div class="status-indicator" id="dashboard-status">Testing...</div>
            <button onclick="testPage('/dashboard', 'dashboard')">Test Dashboard</button>
            <div id="dashboard-result"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“š Books</h2>
            <div class="status-indicator" id="books-status">Testing...</div>
            <button onclick="testPage('/books', 'books')">Test Books</button>
            <div id="books-result"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ Register</h2>
            <div class="status-indicator" id="register-status">Testing...</div>
            <button onclick="testPage('/register', 'register')">Test Register</button>
            <div id="register-result"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ‘¤ Login</h2>
            <div class="status-indicator" id="login-status">Testing...</div>
            <button onclick="testPage('/login', 'login')">Test Login</button>
            <div id="login-result"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”§ Admin Panel</h2>
            <div class="status-indicator" id="admin-status">Testing...</div>
            <button onclick="testPage('/admin', 'admin')">Test Admin</button>
            <div id="admin-result"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“– Book Detail</h2>
            <div class="status-indicator" id="book-detail-status">Testing...</div>
            <button onclick="testBookDetail()">Test Book Detail</button>
            <div id="book-detail-result"></div>
        </div>
    </div>

    <script>
        const testResults = {};
        
        async function testPage(url, pageName) {
            const statusEl = document.getElementById(`${pageName}-status`);
            const resultEl = document.getElementById(`${pageName}-result`);
            
            statusEl.textContent = 'Testing...';
            statusEl.className = 'status-indicator';
            
            try {
                console.log(`ğŸ” Testing ${pageName} page: ${url}`);
                
                const response = await fetch(`http://localhost:5173${url}`);
                
                if (response.ok) {
                    const text = await response.text();
                    resultEl.innerHTML = `<div class="result success">âœ… ${pageName} working! Status: ${response.status}</div>`;
                    statusEl.textContent = 'Working';
                    statusEl.className = 'status-indicator working';
                    testResults[pageName] = true;
                    console.log(`âœ… ${pageName} Status: ${response.status}`);
                } else {
                    resultEl.innerHTML = `<div class="result error">âŒ ${pageName} failed! Status: ${response.status}</div>`;
                    statusEl.textContent = 'Broken';
                    statusEl.className = 'status-indicator broken';
                    testResults[pageName] = false;
                    console.log(`âŒ ${pageName} Status: ${response.status}`);
                }
            } catch (error) {
                resultEl.innerHTML = `<div class="result error">âŒ ${pageName} Error: ${error.message}</div>`;
                statusEl.textContent = 'Error';
                statusEl.className = 'status-indicator broken';
                testResults[pageName] = false;
                console.log(`âŒ ${pageName} Error: ${error.message}`);
            }
        }
        
        async function testBookDetail() {
            // Test a specific book detail
            const bookId = '699768b69336100437a643e4'; // Use a known book ID
            await testPage(`/books/${bookId}`, 'book-detail');
        }
        
        // Test all pages on load
        window.onload = async function() {
            console.log('ğŸ§ª Starting comprehensive page tests...');
            
            // Test each page
            await testPage('/dashboard', 'dashboard');
            await testPage('/books', 'books');
            await testPage('/login', 'login');
            await testPage('/register', 'register');
            await testPage('/admin', 'admin');
            await testBookDetail();
            
            // Summary
            setTimeout(() => {
                const workingPages = Object.entries(testResults).filter(([page, working]) => working).length;
                const brokenPages = Object.entries(testResults).filter(([page, working]) => !working).length;
                
                console.log('\nğŸ“Š Test Summary:');
                console.log(`âœ… Working pages: ${workingPages}`);
                console.log(`âŒ Broken pages: ${brokenPages}`);
                console.log(`ğŸ“ˆ Success rate: ${Math.round((workingPages / (workingPages + brokenPages)) * 100)}%`);
                
                document.body.innerHTML += `
                    <div style="position: fixed; top: 20px; right: 20px; background: white; padding: 20px; border: 2px solid #333; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 1000;">
                        <h3>ğŸ¯ Test Results</h3>
                        <p><strong>âœ… Working: ${workingPages}</strong></p>
                        <p><strong>âŒ Broken: ${brokenPages}</strong></p>
                        <p><strong>ğŸ“ˆ Success Rate: ${Math.round((workingPages / (workingPages + brokenPages)) * 100)}%</strong></p>
                        <button onclick="this.close()" style="margin-top: 10px;">Close</button>
                    </div>
                `;
            }, 2000);
        };
    </script>
</body>
</html>
